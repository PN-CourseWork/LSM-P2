defaults:
  - override hydra/callbacks: mlflow_log
  - _self_

# ============================================================
# Shared defaults for all experiments
# Override via experiment-specific configs or CLI
# ============================================================

# Grid and parallelization
N: 64
n_ranks: 1
numba_threads: 1

# MPI options (null = disabled, set for HPC)
mpi:
  bind_to: null           # e.g., "core" - set to enable binding
  cores_per_node: 24      # Cores per node (used for mapping)
  sockets_per_node: 2     # Sockets per node (for ppr:N:package mapping)

# Set environment variables for the job
# Note: Using hardcoded value since env_set is processed before config merge
hydra:
  job:
    env_set:
      NUMBA_NUM_THREADS: "1"

# Solver selection
solver_type: jacobi  # jacobi, multigrid, fmg
strategy: sliced
communicator: custom
use_numba: false

# Solver parameters
omega: 0.8
max_iter: 1000
tolerance: 1.0e-6

# Multigrid-specific
n_smooth: 3
fmg_post_vcycles: 1  # V-cycles after FMG to converge

# MLflow logging
experiment_name: null
job_name: null
log_dir: logs/lsf

mlflow:
  mode: databricks
  databricks_project_prefix: "/Shared/LSM-PoissonMPI-v2"
